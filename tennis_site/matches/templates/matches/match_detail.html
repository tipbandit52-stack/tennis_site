{% extends "base.html" %}
{% block title %}–ú–∞—Ç—á{% endblock %}

{% block content %}
<div class="card shadow-sm">
  <div class="card-body">
    <h3 class="mb-2">{{ match.player1 }} vs {{ match.player2|default:"(–æ–∂–∏–¥–∞–µ—Ç—Å—è)" }}</h3>
    <p class="mb-1">üìÖ {{ match.date }} {{ match.time }}</p>
    <p class="mb-1">üìç {{ match.location }}</p>
    <p class="mb-3">
      –°—Ç–∞—Ç—É—Å: {{ match.get_status_display }}
      {% if match.score %}, —Å—á—ë—Ç: {{ match.score }}{% endif %}
    </p>

    <div class="d-flex gap-2">
      <a href="{% url 'match_list' %}" class="btn btn-outline-dark btn-sm">–ù–∞–∑–∞–¥</a>

      {% if user.is_authenticated %}
        {# –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è, –µ—Å–ª–∏ –º–∞—Ç—á –æ—Ç–∫—Ä—ã—Ç –∏ –∏–≥—Ä–æ–∫ –Ω–µ —Å–æ–∑–¥–∞—Ç–µ–ª—å #}
        {% if match.is_open and match.player1 != user.player_profile %}
          <form method="post" action="{% url 'join_match' match.pk %}" class="d-inline">
            {% csrf_token %}
            <button type="submit" class="btn btn-success btn-sm">‚úÖ –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è</button>
          </form>
        {% endif %}

        {# –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å, –µ—Å–ª–∏ —ç—Ç–æ —Å–æ–∑–¥–∞—Ç–µ–ª—å –º–∞—Ç—á–∞ #}
        {% if match.player1 == user.player_profile %}
          <a href="{% url 'match_edit' match.pk %}" class="btn btn-dark btn-sm">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
        {% endif %}

        {# –í—ã–π—Ç–∏, –µ—Å–ª–∏ —ç—Ç–æ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–≤—à–∏–π—Å—è –∏–≥—Ä–æ–∫ #}
        {% if match.player2 == user.player_profile %}
          <form method="post" action="{% url 'leave_match' match.pk %}" class="d-inline">
            {% csrf_token %}
            <button type="submit" class="btn btn-outline-danger btn-sm">üö™ –í—ã–π—Ç–∏ –∏–∑ –º–∞—Ç—á–∞</button>
          </form>
        {% endif %}
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
