{% extends "base.html" %}
{% load static %}
{% block title %}–ü—Ä–æ—Ñ–∏–ª—å –∏–≥—Ä–æ–∫–∞{% endblock %}

{% block content %}
<div class="card mb-4 shadow-sm">
  <div class="card-body d-flex flex-wrap gap-3">
    {% if player.photo and player.photo.url %}
      <img src="{{ player.photo.url }}" alt="–§–æ—Ç–æ –∏–≥—Ä–æ–∫–∞" class="profile-photo">
    {% else %}
      <img src="https://via.placeholder.com/300x225?text=Player" alt="–§–æ—Ç–æ –∏–≥—Ä–æ–∫–∞" class="profile-photo">
    {% endif %}

    <div>
      <h3 class="mb-1">{{ player.first_name }} {{ player.last_name }}</h3>
      <p class="mb-1">–í–æ–∑—Ä–∞—Å—Ç: {{ player.age }}</p>
      <p class="mb-1">–£—Ä–æ–≤–µ–Ω—å: {{ player.get_level_display }}</p>
      <p class="mb-1">–ì–æ—Ä–æ–¥/–∞–¥—Ä–µ—Å: {{ player.address|default:"–Ω–µ —É–∫–∞–∑–∞–Ω" }}</p>
      <p class="mb-1">–¢–µ–ª–µ—Ñ–æ–Ω: {{ player.phone_number|default:"‚Äî" }}</p>

      <div class="mt-3 d-flex flex-wrap gap-2">
        {% if user.is_authenticated and user == player.user %}
          <a href="{% url 'player_profile_edit' %}" class="btn btn-dark btn-sm">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</a>
        {% endif %}
        <a href="{% url 'players_list' %}" class="btn btn-outline-dark btn-sm">–ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É</a>

        {% if user.is_authenticated and user != player.user %}
          <form method="post" action="{% url 'send_friend_request' player.user.id %}" class="d-inline">
            {% csrf_token %}
            <button class="btn btn-dark btn-sm">‚ûï –î–æ–±–∞–≤–∏—Ç—å –≤ –¥—Ä—É–∑—å—è</button>
          </form>
          <a href="{% url 'chat:chat_with' player.pk %}" class="btn btn-outline-dark btn-sm">üí¨ –ù–∞–ø–∏—Å–∞—Ç—å</a>
        {% endif %}
      </div>
    </div>
  </div>
</div>

<h4 class="mb-3">üèÖ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h4>
{% if achievements %}
  <div class="row g-3">
    {% for a in achievements %}
      <div class="col-12 col-md-6 col-lg-4">
        <div class="card h-100 shadow-sm">
          {% if a.photo and a.photo.url %}
            <img src="{{ a.photo.url }}" class="card-img-top" style="height:200px; object-fit:cover;" alt="">
          {% else %}
            <img src="https://via.placeholder.com/600x400?text=Achievement" class="card-img-top" style="height:200px; object-fit:cover;" alt="">
          {% endif %}
          <div class="card-body d-flex flex-column">
            <h5 class="card-title">{{ a.title }}</h5>
            <p class="flex-grow-1">{{ a.description }}</p>
            <p class="text-muted small mb-3">üìÖ {{ a.date }}</p>

            {% if user.is_authenticated and user == player.user %}
              <div class="d-flex gap-2">
                <a href="{% url 'edit_achievement' a.pk %}" class="btn btn-outline-dark btn-sm">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                <a href="{% url 'delete_achievement' a.pk %}" class="btn btn-outline-danger btn-sm">üóë –£–¥–∞–ª–∏—Ç—å</a>
              </div>
            {% endif %}
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
{% else %}
  <p class="text-muted">–£ –∏–≥—Ä–æ–∫–∞ –ø–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π.</p>
{% endif %}

{% if user.is_authenticated and user == player.user %}
  <div class="text-center mt-4">
    <a href="{% url 'add_achievement' player.pk %}" class="btn btn-dark">‚ûï –î–æ–±–∞–≤–∏—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ</a>
  </div>
{% endif %}
{% endblock %}
